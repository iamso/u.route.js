/*!
 * u.route.js - Version 0.2.0
 * simple routing for the browser
 * Author: Steve Ottoz <so@dev.so>
 * Build date: 2016-04-04
 * Copyright (c) 2016 Steve Ottoz
 * Released under the MIT license
 */
!function(a){"use strict";if(!a&&!a.pushState)return!1;var b=a.pushState,c=a.replaceState;a.pushState=function(c){var d=b.apply(a,arguments);return/^f/.test(typeof a.onpushstate)&&a.onpushstate(c),d},a.replaceState=function(b){var d=c.apply(a,arguments);return/^f/.test(typeof a.onpushstate)&&a.onpushstate(b),d}}(window.history),function(u,a,b,c){"use strict";function d(a,b,c,d){return a instanceof RegExp?a:(a instanceof Array&&(a="("+a.join("|")+")"),a=a.concat(d?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,c,d,e,f,g){return b.push({name:e,optional:!!g}),c=c||"",""+(g?"":c)+"(?:"+(g?c:"")+(d||"")+(f||d&&"([^/.]+?)"||"([^/]+?)")+")"+(g||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+a+"$",c?"":"i"))}function e(){var b,c={},d=/[?&]?([^=]+)=([^&]*)/g,e=a.location.search;for(e=e.split("+").join(" ");b=d.exec(e);)c[decodeURIComponent(b[1])]=decodeURIComponent(b[2]);return c}var f=b&&b.pushState,g=[],h=[],i="",j="",k=!1,l="#!";u.route=function(a,b,c){var e={};e.path=a,e.mw=c?b:null,e.fn=c||b,e.keys=[],e.params={},e.regex=d(e.path,e.keys,!1,!1),g.push(e)},u.route.use=function(a){/^f/.test(typeof a)&&h.indexOf(a)<0&&h.push(a)},u.route.redirect=function(c,d){k?a.location.hash=l+c:f?(d?b.replaceState:b.pushState)({url:c,date:new Date},null,c):a.location.href=c},u.route.reload=function(b){var c,d,f=k?location.hash.replace(l,""):(b&&b.url?b.url:a.location.pathname).split("?")[0],m=!0,n={},o=u.extend({},location,{params:n,pathname:f,query:e()});u.each(g,function(a,b){c||(d=f.match(b.regex))&&(c=b)}),c?(d&&(d.shift(),d=u.toArray(d)),u.each(d,function(a,b){n[c.keys[a].name]=b}),o=u.extend(o,{route:c.path,params:n}),u.each(h,function(b,c){var d=c.apply(a,[o]);m=d===!1?d:m}),m&&(c.mw?c.mw.apply(a,[o])!==!1&&c.fn.apply(a,[o]):c.fn.apply(a,[o]))):(u.each(h,function(b,c){var d=c.apply(a,[o]);m=d===!1?d:m}),m&&(o=u.extend(o,{route:null}),u.route["default"]&&u.route["default"].apply(a,[o]))),i=f,j=location.hash},u.route.init=function(c,d){k=c,l=d||l,!k&&f&&(b.onpushstate=u.route.reload),u(a).on("popstate",function(a){return k||i!==a.target.location.pathname||i===a.target.location.hash?void u.route.reload():(a.preventDefault(),!1)}),u.route.reload()}}(ujs,window,window.history);
//# sourceMappingURL=u.route.min.js.map